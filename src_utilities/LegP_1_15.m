function [f] = LegP_1_15(x,index)

[c,l] = size(x);
if c ~= 1 && l ~= 1
    error('LegP_1_15.m: problem with the dimension of the random number xi! Exit!')
end

if l == 1,
    x = x';
    tmp = l;
    l = c;
    c = tmp; clear tmp;
end
 
switch index
    case 1,
        f = zeros(1,l);
    case 2,
        f = ones(1,l);
    case 3,
        f = 0.5.*(2.*3.*x(1,:));
    case 4,
        f = 0.5.*(3.*5.*x(1,:).^2 - 3);
    case 5,
        f = 0.125.*(4.*35.*x(1,:).^3 - 2.*30.*x(1,:));
    case 6,
        f = 0.125.*(5.*63.*x(1,:).^4 - 3.*70.*x(1,:).^2 + 15);
    case 7,
        f = 0.0625.*(6.*231.*x(1,:).^5 - 4.*315.*x(1,:).^3 + 2.*105.*x(1,:));
    case 8,
        f = 0.0625.*(7.*429.*x(1,:).^6 - 5.*693.*x(1,:).^4 + 3.*315.*x(1,:).^2 - 35);
    case 9,
        f = (8.*6435.*x(1,:).^7 - 6.*12012.*x(1,:).^5 + 4.*6930.*x(1,:).^3 - 2.*1260.*x(1,:))./128;
    case 10,
        f = 9*12155/128.*x(1,:).^8 - 7*6435/32.*x(1,:).^6 + 5*9009/64.*x(1,:).^4 - 3*1155/32.*x(1,:).^2 + 315/128;
    case 11,
        f = 10*46189/256.*x(1,:).^9 - 8*109395/256.*x(1,:).^7 + 6*45045/128.*x(1,:).^5 - 4*15015/128.*x(1,:).^3 +2*3465/256.*x(1,:);
    case 12,
        f = 11*88179/256.*x(1,:).^10 - 9*230945/256.*x(1,:).^8 + 7*109395/128.*x(1,:).^6 - 5*45045/128.*x(1,:).^4 +3*15015/256.*x(1,:).^2 - 693/256;
    case 13,
        f = 12*676039/1024.*x(1,:).^11 - 10*969969/512.*x(1,:).^9 + 8*2078505/1024.*x(1,:).^7 - 6*255255/256.*x(1,:).^5 + 4*225225/1024.*x(1,:).^3 - 2*9009/512.*x(1,:);
    case 14,
        f = 13*1300075/1024.*x(1,:).^12 - 11*2028117/512.*x(1,:).^10 + 9*4849845/1024.*x(1,:).^8 - 7*692835/256.*x(1,:).^6 + 5*765765/1024.*x(1,:).^4 - 3*45045/512.*x(1,:).^2 + 3003/1024;
    case 15,
        f = 14*5014575/2048.*x(1,:).^13 - 12*16900975/2048.*x(1,:).^11 + 10*22309287/2048.*x(1,:).^9 - 8*14549535/2048.*x(1,:).^7 + 6*4849845/2048.*x(1,:).^5 - 4*765765/2048.*x(1,:).^3 + 2*45045/2048.*x(1,:);
    case 16,
        f = 15*9694845/2048.*x(1,:).^14 - 13*35102025/2048.*x(1,:).^12 + 11*50702925/2048.*x(1,:).^10 - 9*37182145/2048.*x(1,:).^8 + 7*14549535/2048.*x(1,:).^6 - 5*2909907/2048.*x(1,:).^4 +3*255255/2048.*x(1,:).^2 - 6435/2048;
    otherwise,
        error('LegP_1_15.m: only works for order n<16!');
end
