function [f] = Leg_1_15(x,index,n)

[c,l] = size(x);
if c ~= 1 && l ~= 1
    error('Leg_1_15.m: problem with the dimension of the random number x! Exit!')
end

if l == 1,
    x = x';
    tmp = l;
    l = c;
    c = tmp; clear tmp;
end
 
if n == 1,
    switch index
        case 1,
            f = ones(1,l);
        case 2,
            f = x(1,:);
        case 3,
            f = 0.5.*(3.*x(1,:).^2-1);
        case 4,
            f = 0.5.*(5.*x(1,:).^3-3.*x(1,:));
        case 5,
            f = 0.125.*(35.*x(1,:).^4 - 30.*x(1,:).^2 + 3);
        case 6,
            f = 0.125.*(63.*x(1,:).^5 - 70.*x(1,:).^3 + 15.*x(1,:));
        case 7,
            f = 0.0625.*(231.*x(1,:).^6 - 315.*x(1,:).^4 + 105.*x(1,:).^2 - 5);
        case 8,
            f = 0.0625.*(429.*x(1,:).^7 - 693.*x(1,:).^5 + 315.*x(1,:).^3 - 35.*x(1,:));
        case 9,
            f = (6435.*x(1,:).^8 - 12012.*x(1,:).^6 + 6930.*x(1,:).^4 -1260.*x(1,:).^2 + 35)./128;
        case 10,
            f = 12155/128.*x(1,:).^9 - 6435/32.*x(1,:).^7 + 9009/64.*x(1,:).^5 - 1155/32.*x(1,:).^3 + 315/128.*x(1,:);
        case 11,
            f = 46189/256.*x(1,:).^10 - 109395/256.*x(1,:).^8 + 45045/128.*x(1,:).^6 - 15015/128.*x(1,:).^4 +3465/256.*x(1,:).^2 - 63/256;
        case 12,
            f = 88179/256.*x(1,:).^11 - 230945/256.*x(1,:).^9 + 109395/128.*x(1,:).^7 - 45045/128.*x(1,:).^5 +15015/256.*x(1,:).^3 - 693/256.*x(1,:);
        case 13,
            f = 676039/1024.*x(1,:).^12 - 969969/512.*x(1,:).^10 + 2078505/1024.*x(1,:).^8 - 255255/256.*x(1,:).^6 + 225225/1024.*x(1,:).^4 - 9009/512.*x(1,:).^2 + 231/1024;
        case 14,
            f = 1300075/1024.*x(1,:).^13 - 2028117/512.*x(1,:).^11 + 4849845/1024.*x(1,:).^9 - 692835/256.*x(1,:).^7 + 765765/1024.*x(1,:).^5 - 45045/512.*x(1,:).^3 + 3003/1024.*x(1,:);
        case 15,
            f = 5014575/2048.*x(1,:).^14 - 16900975/2048.*x(1,:).^12 + 22309287/2048.*x(1,:).^10 - 14549535/2048.*x(1,:).^8 + 4849845/2048.*x(1,:).^6 - 765765/2048.*x(1,:).^4 + 45045/2048.*x(1,:).^2 - 429/2048;
        case 16,
            f = 9694845/2048.*x(1,:).^15 - 35102025/2048.*x(1,:).^13 + 50702925/2048.*x(1,:).^11 - 37182145/2048.*x(1,:).^9 + 14549535/2048.*x(1,:).^7 - 2909907/2048.*x(1,:).^5 +255255/2048.*x(1,:).^3 - 6435/2048.*x(1,:);
        otherwise,
            error('problem with Leg_1_15.m: only works for order n<16!');
    end
else,
    f = zeros(n,length(x));
    for i=1:n,
        f(i,:) = Leg_1_15(x,i,0);
    end
end

%f=f'; %WARNING, sometimes needs to be turned off
